{"version":3,"mappings":";4CAIA,EAAO,QAAS,oBAAqB,eAAmC,EAAc,CACpF,EAAM,gBAAgB,CACtB,KAAK,UAAU,OAAO,mBAAmB,CAEzC,GAAM,CACJ,OACA,QACA,YACA,cACA,MACA,eACA,QACA,SACA,OACA,SACA,aACA,UACA,UACA,8BAdI,CACJ,OACA,QACA,YACA,cACA,MACA,eACA,QACA,SACA,OACA,SACA,aACA,UACA,UACA,SACE,MAAM,OAAO,sBAdf,OACA,QACA,YACA,cACA,MACA,eACA,QACA,SACA,OACA,SACA,aACA,UACA,UACA,cAEF,yBAAO,uBAEP,GAAM,CAAE,cAAe,EAAQ,SAAQ,SAAQ,cAAe,KAAK,QAE7D,EAAM,OAAO,WAAW,GAAU,IAAI,CACtC,EAAM,OAAO,WAAW,GAAU,IAAI,CACtC,EAAO,IAAI,EAAK,CAAE,QAAS,GAAI,eAAgB,GAAO,CAAC,CACvD,EAAM,IAAI,EAAM,CACZ,SACR,OAAQ,CAAC,IAAI,EAAU,CAAE,OAAQ,IAAI,EAAI,CAAE,QAAS,GAAI,CAAC,CAAE,CAAC,CAAC,CACvD,OACP,CAAC,CAEF,GAAI,CACF,IAAM,EAAe,IAAI,EAAa,CACpC,SAAU,CACR,IAAI,EAAQ,CACV,SAAU,IAAI,EAAM,EAAW,CAAC,EAAK,EAAI,CAAC,CAAC,CAC5C,CAAC,CACH,CACF,CAAC,CAEI,EAAc,IAAI,EAAY,CAClC,OAAQ,EACR,MAAO,IAAI,EAAM,CACf,MAAO,IAAI,EAAO,CAChB,OAAQ,EACR,KAAM,IAAI,EAAK,CAAE,MAAO,UAAW,CAAC,CACrC,CAAC,CACH,CAAC,CACH,CAAC,CAEF,EAAI,SAAS,EAAY,OAClB,EAAO,CACd,QAAQ,MAAM,iCAAkC,EAAM,CAGxD,GAAI,EACF,GAAI,CACF,IAAM,EAAY,IAAI,EAAa,CACjC,SAAU,IAAI,GAAS,CAAC,aAAa,KAAK,MAAM,EAAW,CAAE,CAC3D,eAAgB,YAChB,kBAAmB,YACpB,CAAC,CACH,CAAC,CAEI,EAAW,IAAI,EAAY,CAC/B,OAAQ,EACR,MAAO,IAAI,EAAM,CACf,OAAQ,IAAI,EAAO,CAAE,MAAO,UAAW,MAAO,EAAG,CAAC,CAClD,KAAM,IAAI,EAAK,CAAE,MAAO,YAAa,CAAC,CACvC,CAAC,CACH,CAAC,CAEF,EAAI,SAAS,EAAS,CAEtB,EAAK,IAAI,EAAU,WAAW,CAAE,CAAE,QAAS,CAAC,GAAI,GAAI,GAAI,GAAG,CAAE,CAAC,OACvD,EAAO,CACd,QAAQ,MAAM,kCAAmC,EAAM,GAG3D","names":[],"ignoreList":[],"sources":["../../../../../client/simple/src/js/main/mapresult.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\r\n\r\nimport { listen } from \"../core/toolkit.ts\";\r\n\r\nlisten(\"click\", \".searxng_init_map\", async function (this: HTMLElement, event: Event) {\r\n  event.preventDefault();\r\n  this.classList.remove(\"searxng_init_map\");\r\n\r\n  const {\r\n    View,\r\n    OlMap,\r\n    TileLayer,\r\n    VectorLayer,\r\n    OSM,\r\n    VectorSource,\r\n    Style,\r\n    Stroke,\r\n    Fill,\r\n    Circle,\r\n    fromLonLat,\r\n    GeoJSON,\r\n    Feature,\r\n    Point\r\n  } = await import(\"../pkg/ol.ts\");\r\n  import(\"ol/ol.css\");\r\n\r\n  const { leafletTarget: target, mapLon, mapLat, mapGeojson } = this.dataset;\r\n\r\n  const lon = Number.parseFloat(mapLon || \"0\");\r\n  const lat = Number.parseFloat(mapLat || \"0\");\r\n  const view = new View({ maxZoom: 16, enableRotation: false });\r\n  const map = new OlMap({\r\n    target: target,\r\n    layers: [new TileLayer({ source: new OSM({ maxZoom: 16 }) })],\r\n    view: view\r\n  });\r\n\r\n  try {\r\n    const markerSource = new VectorSource({\r\n      features: [\r\n        new Feature({\r\n          geometry: new Point(fromLonLat([lon, lat]))\r\n        })\r\n      ]\r\n    });\r\n\r\n    const markerLayer = new VectorLayer({\r\n      source: markerSource,\r\n      style: new Style({\r\n        image: new Circle({\r\n          radius: 6,\r\n          fill: new Fill({ color: \"#3050ff\" })\r\n        })\r\n      })\r\n    });\r\n\r\n    map.addLayer(markerLayer);\r\n  } catch (error) {\r\n    console.error(\"Failed to create marker layer:\", error);\r\n  }\r\n\r\n  if (mapGeojson) {\r\n    try {\r\n      const geoSource = new VectorSource({\r\n        features: new GeoJSON().readFeatures(JSON.parse(mapGeojson), {\r\n          dataProjection: \"EPSG:4326\",\r\n          featureProjection: \"EPSG:3857\"\r\n        })\r\n      });\r\n\r\n      const geoLayer = new VectorLayer({\r\n        source: geoSource,\r\n        style: new Style({\r\n          stroke: new Stroke({ color: \"#3050ff\", width: 2 }),\r\n          fill: new Fill({ color: \"#3050ff33\" })\r\n        })\r\n      });\r\n\r\n      map.addLayer(geoLayer);\r\n\r\n      view.fit(geoSource.getExtent(), { padding: [20, 20, 20, 20] });\r\n    } catch (error) {\r\n      console.error(\"Failed to create GeoJSON layer:\", error);\r\n    }\r\n  }\r\n});\r\n"],"file":"js/mapresult.min.js"}